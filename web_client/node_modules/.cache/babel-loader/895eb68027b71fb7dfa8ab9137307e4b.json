{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Aysha\\\\Desktop\\\\Aysha\\\\SJSU\\\\Fall 2019\\\\CMPE 295A\\\\project\\\\frontend\\\\src\\\\components\\\\LiveSurveillance\\\\LiveSurveillance.js\";\nimport React, { Component } from \"react\";\nimport '../../App.css';\nimport LeftDrawer from '../Drawer/Drawer';\nimport * as videoStyles from \"../../styles/video\";\nimport axios from 'axios';\nimport { connect } from \"react-redux\";\nimport backendURL from '../../backendUrl';\nimport { Redirect } from \"react-router-dom\";\nimport ReactHLS from 'react-hls';\nimport Hls from \"hls.js\";\nimport $ from \"jquery\";\nimport AWS from \"aws-sdk\";\nimport * as awsConfig from \"../../aws-config/aws\";\n\nclass LiveSurveillance extends Component {\n  constructor(props) {\n    super(props);\n\n    if (sessionStorage.getItem(\"user\") == null || sessionStorage.getItem(\"user\") == \"null\") {\n      this.state = {\n        redirectVar: React.createElement(Redirect, {\n          to: \"/signin\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 22\n          },\n          __self: this\n        })\n      };\n    } else {\n      this.state = {\n        redirectVar: null\n      };\n    }\n  }\n\n  render() {\n    var date = new Date().getMonth() + 1 + \"/\" + new Date().getDate() + \"/\" + new Date().getFullYear();\n    var location = \"MLK Library Main entrance, San Jose, CA\";\n    var camera = \"Camera001\";\n    var streamName = 'threatStream';\n    var playbackMode = 'LIVE';\n    var options = {\n      accessKeyId: awsConfig.config.accessKeyId,\n      secretAccessKey: awsConfig.config.secretAccessKey,\n      sessionToken: undefined,\n      region: awsConfig.config.region,\n      endpoint: undefined\n    };\n    var kinesisVideo = new AWS.KinesisVideo(options);\n    var kinesisVideoArchivedContent = new AWS.KinesisVideoArchivedMedia(options);\n    kinesisVideo.getDataEndpoint({\n      StreamName: streamName,\n      APIName: \"GET_HLS_STREAMING_SESSION_URL\"\n    }, function (err, response) {\n      if (err) {\n        console.error(err);\n        return;\n      }\n\n      kinesisVideoArchivedContent.endpoint = new AWS.Endpoint(response.DataEndpoint);\n      kinesisVideoArchivedContent.getHLSStreamingSessionURL({\n        StreamName: streamName,\n        PlaybackMode: playbackMode,\n        HLSFragmentSelector: {\n          FragmentSelectorType: 'SERVER_TIMESTAMP',\n          TimestampRange: playbackMode === \"LIVE\" ? undefined : {\n            StartTimestamp: new Date($('#startTimestamp').val()),\n            EndTimestamp: new Date($('#endTimestamp').val())\n          }\n        }\n      }, function (err, response) {\n        if (err) {\n          return console.error(err);\n        }\n\n        var playerElement = $('#hlsjs');\n        playerElement.show();\n        var player = new Hls();\n        player.loadSource(response.HLSStreamingSessionURL);\n        player.attachMedia(playerElement[0]);\n        player.on(Hls.Events.MANIFEST_PARSED, function () {\n          $('#hlsjs').play();\n        });\n      });\n    });\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, this.state.redirectVar, React.createElement(LeftDrawer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: videoStyles.videoDisplayContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(\"video\", {\n      style: videoStyles.videoDisplay,\n      id: \"hlsjs\",\n      controls: true,\n      autoPlay: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      style: videoStyles.videoContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: videoStyles.liveVideoInfo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, \" Date: \", date, \" \\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0 Location: \", location, \"  \\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0  Camera: \", camera))));\n  }\n\n}\n\nexport default LiveSurveillance;","map":{"version":3,"sources":["C:/Users/Aysha/Desktop/Aysha/SJSU/Fall 2019/CMPE 295A/project/frontend/src/components/LiveSurveillance/LiveSurveillance.js"],"names":["React","Component","LeftDrawer","videoStyles","axios","connect","backendURL","Redirect","ReactHLS","Hls","$","AWS","awsConfig","LiveSurveillance","constructor","props","sessionStorage","getItem","state","redirectVar","render","date","Date","getMonth","getDate","getFullYear","location","camera","streamName","playbackMode","options","accessKeyId","config","secretAccessKey","sessionToken","undefined","region","endpoint","kinesisVideo","KinesisVideo","kinesisVideoArchivedContent","KinesisVideoArchivedMedia","getDataEndpoint","StreamName","APIName","err","response","console","error","Endpoint","DataEndpoint","getHLSStreamingSessionURL","PlaybackMode","HLSFragmentSelector","FragmentSelectorType","TimestampRange","StartTimestamp","val","EndTimestamp","playerElement","show","player","loadSource","HLSStreamingSessionURL","attachMedia","on","Events","MANIFEST_PARSED","play","videoDisplayContainer","videoDisplay","videoContainer","liveVideoInfo"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport '../../App.css';\r\nimport LeftDrawer from '../Drawer/Drawer';\r\nimport * as videoStyles from  \"../../styles/video\";\r\nimport axios from 'axios';\r\nimport { connect } from \"react-redux\";\r\nimport backendURL from '../../backendUrl';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport ReactHLS from 'react-hls';\r\nimport Hls from \"hls.js\";\r\nimport $ from \"jquery\";\r\nimport AWS from \"aws-sdk\";\r\nimport * as awsConfig from \"../../aws-config/aws\";\r\n\r\nclass LiveSurveillance extends Component {\r\n\r\n    constructor(props){\r\n        super(props); \r\n        if(sessionStorage.getItem(\"user\") == null || sessionStorage.getItem(\"user\") == \"null\")\r\n       {\r\n           this.state = {\r\n                redirectVar :  <Redirect to= \"/signin\"/>\r\n           }\r\n       }\r\n       else{\r\n        \r\n           this.state = {\r\n               redirectVar :  null\r\n           }\r\n\r\n    \r\n       }\r\n        \r\n    }\r\n  \r\n    render() {\r\n        \r\n        var date = (new Date().getMonth() + 1) + \"/\" + new Date().getDate() + \"/\" + new Date().getFullYear();\r\n        var location = \"MLK Library Main entrance, San Jose, CA\";\r\n        var camera = \"Camera001\";\r\n       \r\n        var streamName = 'threatStream';\r\n        var playbackMode = 'LIVE';\r\n\r\n        var options = {\r\n            accessKeyId: awsConfig.config.accessKeyId,\r\n            secretAccessKey: awsConfig.config.secretAccessKey,\r\n            sessionToken:  undefined,\r\n            region: awsConfig.config.region,\r\n            endpoint: undefined\r\n        }\r\n\r\n        var kinesisVideo = new AWS.KinesisVideo(options);\r\n        var kinesisVideoArchivedContent = new AWS.KinesisVideoArchivedMedia(options);\r\n        kinesisVideo.getDataEndpoint({\r\n            StreamName: streamName,\r\n            APIName: \"GET_HLS_STREAMING_SESSION_URL\"\r\n        }, function(err, response) {\r\n            if (err) {  \r\n                console.error(err);\r\n                return;\r\n             }\r\n            \r\n            kinesisVideoArchivedContent.endpoint = new AWS.Endpoint(response.DataEndpoint);\r\n\r\n          \r\n                kinesisVideoArchivedContent.getHLSStreamingSessionURL({\r\n                    StreamName: streamName,\r\n                    PlaybackMode: playbackMode,\r\n                    HLSFragmentSelector: {\r\n                        FragmentSelectorType: 'SERVER_TIMESTAMP',\r\n                        TimestampRange: playbackMode === \"LIVE\" ? undefined : {\r\n                            StartTimestamp: new Date($('#startTimestamp').val()),\r\n                            EndTimestamp: new Date($('#endTimestamp').val())\r\n                        }\r\n                    },\r\n                   \r\n                }, function(err, response) {\r\n                    if (err) { return console.error(err); }\r\n                    \r\n                        var playerElement = $('#hlsjs');\r\n                        playerElement.show();\r\n                        var player = new Hls();\r\n                      \r\n                        player.loadSource(response.HLSStreamingSessionURL);\r\n                        player.attachMedia(playerElement[0]);\r\n                        player.on(Hls.Events.MANIFEST_PARSED, function() {\r\n                            $('#hlsjs').play();\r\n                        });\r\n                    \r\n                });\r\n        \r\n        });\r\n\r\n            return (\r\n           <div>\r\n               {this.state.redirectVar}\r\n                 <LeftDrawer></LeftDrawer>\r\n                 <div style={videoStyles.videoDisplayContainer}  >\r\n                           <video style={videoStyles.videoDisplay} id=\"hlsjs\"  controls autoPlay></video>\r\n\r\n                      </div> \r\n                 <div  style={videoStyles.videoContainer}  >\r\n\r\n                 \r\n                   <div style = {videoStyles.liveVideoInfo}>{/* <Timer></Timer> */}<h5> Date: {date} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Location: {location}  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Camera: {camera}</h5></div>\r\n               \r\n               </div>\r\n          \r\n                \r\n            </div> \r\n\r\n            );\r\n    \r\n    }\r\n}\r\n\r\n\r\n\r\nexport default LiveSurveillance;  \r\n"]},"metadata":{},"sourceType":"module"}