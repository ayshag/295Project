{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Aysha\\\\Desktop\\\\Aysha\\\\SJSU\\\\Fall 2019\\\\CMPE 295A\\\\project\\\\frontend\\\\src\\\\components\\\\SurveillanceHistory\\\\SurveillanceHistory.js\";\nimport React, { Component } from \"react\";\nimport '../../App.css';\nimport LeftDrawer from '../Drawer/Drawer';\nimport * as videoStyles from \"../../styles/video\";\nimport axios from 'axios';\nimport { connect } from \"react-redux\";\nimport { SignalingClient } from 'amazon-kinesis-video-streams-webrtc';\nimport backendURL from '../../backendUrl';\nimport { Redirect } from \"react-router-dom\";\nimport ReactHLS from 'react-hls';\nimport Hls from \"hls.js\";\nimport $ from \"jquery\";\nimport AWS from \"aws-sdk\";\nimport Button from '@material-ui/core/Button';\nimport DateTimePicker from 'react-datetime-picker';\nimport DatePicker from 'react-datepicker';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport TimePicker from 'rc-time-picker';\nimport 'rc-time-picker/assets/index.css';\n\nclass SurveillanceHistory extends Component {\n  constructor(props) {\n    super(props);\n\n    this.startDateChange = date => {\n      this.setState({\n        startDate: date\n      });\n    };\n\n    this.endDateChange = date => {\n      this.setState({\n        endDate: date\n      });\n    };\n\n    this.startTimeChange = time => {\n      this.setState({\n        startTime: time\n      });\n    };\n\n    this.endTimeChange = time => {\n      this.setState({\n        endTime: time\n      });\n    };\n\n    this.convertMonth = month => {\n      switch (month) {\n        case 'Jan':\n          return 1;\n\n        case 'Feb':\n          return 2;\n\n        case 'Mar':\n          return 3;\n\n        case 'Apr':\n          return 4;\n\n        case 'May':\n          return 5;\n\n        case 'Jun':\n          return 6;\n\n        case 'Jul':\n          return 7;\n\n        case 'Aug':\n          return 8;\n\n        case 'Sept':\n          return 9;\n\n        case 'Oct':\n          return 10;\n\n        case 'Nov':\n          return 11;\n\n        case 'Dec':\n          return 12;\n      }\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n\n      if (this.state.startTime) {\n        var startTime = this.state.startTime._d.toString().split(' ');\n\n        var startDate = this.state.startDate.toString().split(' ');\n\n        var endTime = this.state.endTime._d.toString().split(' ');\n\n        var endDate = this.state.endDate.toString().split(' ');\n        console.log(startTime);\n        console.log(startDate);\n        console.log(startTime[0]);\n        console.log(startDate[1]);\n        console.log(endTime[0]);\n        console.log(endTime[1]); //  var startMonth = convertMonth(startDate[1]);\n        //  var endMonth = convertMonth(endDate[1]);\n\n        var startMonth, endMonth;\n\n        switch (startDate[1]) {\n          case 'Jan':\n            startMonth = 1;\n            break;\n\n          case 'Feb':\n            startMonth = 2;\n            break;\n\n          case 'Mar':\n            startMonth = 3;\n            break;\n\n          case 'Apr':\n            startMonth = 4;\n            break;\n\n          case 'May':\n            startMonth = 5;\n            break;\n\n          case 'Jun':\n            startMonth = 6;\n            break;\n\n          case 'Jul':\n            startMonth = 7;\n            break;\n\n          case 'Aug':\n            startMonth = 8;\n            break;\n\n          case 'Sept':\n            startMonth = 9;\n            break;\n\n          case 'Oct':\n            startMonth = 10;\n            break;\n\n          case 'Nov':\n            startMonth = 11;\n            break;\n\n          case 'Dec':\n            startMonth = 12;\n        }\n\n        switch (endDate[1]) {\n          case 'Jan':\n            endMonth = 1;\n            break;\n\n          case 'Feb':\n            endMonth = 2;\n            break;\n\n          case 'Mar':\n            endMonth = 3;\n            break;\n\n          case 'Apr':\n            endMonth = 4;\n            break;\n\n          case 'May':\n            endMonth = 5;\n            break;\n\n          case 'Jun':\n            endMonth = 6;\n            break;\n\n          case 'Jul':\n            endMonth = 7;\n            break;\n\n          case 'Aug':\n            endMonth = 8;\n            break;\n\n          case 'Sept':\n            endMonth = 9;\n            break;\n\n          case 'Oct':\n            endMonth = 10;\n            break;\n\n          case 'Nov':\n            endMonth = 11;\n            break;\n\n          case 'Dec':\n            endMonth = 12;\n        }\n\n        var start = startDate[3] + '-' + startMonth + '-' + startDate[2] + 'T' + startTime[4] + '.000Z';\n        var end = endDate[3] + '-' + endMonth + '-' + endDate[2] + 'T' + endTime[4] + '.000Z';\n        var data = {\n          start: start,\n          end: end\n        }; // this.props.setTimeStamp(data);\n\n        this.setState({\n          startTimeStamp: start,\n          endTimeStamp: end\n        });\n        /*2020-04-19T23:35:10.551Z\r\n        2020-04-19T23:40:04.447Z*/\n      }\n    };\n\n    this.state = {\n      startDate: null,\n      endDate: null,\n      startTime: null,\n      endTime: null,\n      startTimeStamp: null,\n      endTimeStamp: null\n    };\n    this.render = this.render.bind(this);\n  }\n\n  componentDidMount() {// console.log(\"user : \"  + sessionStorage.getItem(\"user\"))\n    // if(sessionStorage.getItem(\"user\") == null)\n    //   this.setState({redirectVar : <Redirect to= \"/signin\"/>})\n  }\n\n  componentWillMount() {}\n\n  render() {\n    var startTimeStamp = this.state.startTimeStamp + '';\n    var endTimeStamp = this.state.endTimeStamp;\n    var protocol = 'HLS';\n    var streamName = 'threatStream';\n    var playbackMode = 'ON_DEMAND';\n    var playerName = 'HLS.js';\n    var options = {\n      accessKeyId: 'AKIAXBXQVKC4TY2ZUR6V',\n      secretAccessKey: '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',\n      sessionToken: undefined,\n      region: 'us-east-1',\n      endpoint: undefined\n    };\n    var kinesisVideo = new AWS.KinesisVideo(options);\n    var kinesisVideoArchivedContent = new AWS.KinesisVideoArchivedMedia(options);\n    kinesisVideo.getDataEndpoint({\n      StreamName: streamName,\n      APIName: \"GET_HLS_STREAMING_SESSION_URL\"\n    }, function (err, response) {\n      if (err) {\n        return console.error(err);\n      }\n\n      console.log('Data endpoint: ' + response.DataEndpoint);\n      kinesisVideoArchivedContent.endpoint = new AWS.Endpoint(response.DataEndpoint); // Step 3: Get a Streaming Session URL\n\n      var consoleInfo = 'Fetching ' + protocol + ' Streaming Session URL';\n      console.log(consoleInfo);\n      console.log(startTimeStamp);\n      console.log(typeof startTimeStamp);\n      console.log(typeof '2020-04-20T04:29:49.000Z');\n      console.log(new Date('2020-04-20T04:29:49.000Z'));\n      console.log(startTimeStamp === '2020-04-20T04:29:49.000Z');\n      kinesisVideoArchivedContent.getHLSStreamingSessionURL({\n        StreamName: streamName,\n        PlaybackMode: playbackMode,\n        HLSFragmentSelector: {\n          FragmentSelectorType: 'SERVER_TIMESTAMP',\n          TimestampRange: {\n            StartTimestamp: new Date('2020-04-20T04:29:49.000Z'),\n            EndTimestamp: new Date('2020-04-20T05:29:49.000Z')\n          }\n        },\n        ContainerFormat: $('#containerFormat').val(),\n        DiscontinuityMode: $('#discontinuityMode').val(),\n        DisplayFragmentTimestamp: $('#displayFragmentTimestamp').val(),\n        MaxMediaPlaylistFragmentResults: parseInt($('#maxResults').val()),\n        Expires: parseInt($('#expires').val())\n      }, function (err, response) {\n        if (err) {\n          return console.log(err);\n        }\n\n        console.log('HLS Streaming Session URL: ' + response.HLSStreamingSessionURL); // Step 4: Give the URL to the video player.\n\n        var playerElement = $('#hlsjs');\n        playerElement.show();\n        var player = new Hls();\n        console.log('Created HLS.js Player');\n        player.loadSource(response.HLSStreamingSessionURL);\n        player.attachMedia(playerElement[0]);\n        console.log('Set player source');\n        player.on(Hls.Events.MANIFEST_PARSED, function () {\n          $('#hlsjs').play();\n          console.log('Starting playback');\n        });\n      });\n    });\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, React.createElement(LeftDrawer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: videoStyles.videoDisplayContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, React.createElement(\"video\", {\n      style: videoStyles.videoDisplay,\n      id: \"hlsjs\",\n      controls: true,\n      autoPlay: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      style: videoStyles.videoContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: videoStyles.videoInfo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    }, \" \", React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241\n      },\n      __self: this\n    }, \" Enter Start Date \", React.createElement(DatePicker, {\n      selected: this.state.startDate,\n      onChange: this.startDateChange,\n      style: 'border : 1px',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241\n      },\n      __self: this\n    }), \" Enter Start Time \", React.createElement(TimePicker, {\n      onChange: this.startTimeChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241\n      },\n      __self: this\n    }, \" \")), React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, \" Enter End Date \", React.createElement(DatePicker, {\n      selected: this.state.endDate,\n      onChange: this.endDateChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }), \" Enter End Time \", React.createElement(TimePicker, {\n      onChange: this.endTimeChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    })), React.createElement(Button, {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, \"Go\")), React.createElement(\"input\", {\n      id: \"startTimestamp\",\n      type: \"datetime-local\",\n      class: \"form-control form-control-sm\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      id: \"endTimestamp\",\n      type: \"datetime-local\",\n      class: \"form-control form-control-sm\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    startTimeStamp: state.surveillanceReducer.startTimeStamp,\n    endTimeStamp: state.surveillanceReducer.endTimeStamp\n  };\n};\n\nconst mapDispatchStateToProps = dispatch => {\n  return {\n    //  setTimeStamp : (data) =>{\n    //      dispatch({type : \"history-timestamps\",data });\n    //  },\n    threats: () => {\n      /*  axios.get(backendURL + '/all-threats').then(response=>{\r\n            console.log(response.data);\r\n          // const threatIds = response.data;\r\n           axios.post(backendURL + '/threat-details', response.data).then(response=>{\r\n                  //   console.log(result);\r\n                     dispatch({type: \"threats\",payload : response.data})\r\n            })\r\n              \r\n        }) */\n      axios.get(backendURL + '/all-threats').then(response => {\n        var threatsData = []; //dispatch({type: \"threats\",payload : response.data})\n\n        for (var i = 0; i < response.data.length; i++) {\n          axios.post(backendURL + '/threat-details', response.data[i]).then(result => {\n            threatsData.push(result.data);\n          }).then(function () {\n            if (threatsData.length == response.data.length) dispatch({\n              type: \"threats\",\n              payload: threatsData\n            });\n          });\n        }\n      });\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchStateToProps)(SurveillanceHistory);","map":{"version":3,"sources":["C:/Users/Aysha/Desktop/Aysha/SJSU/Fall 2019/CMPE 295A/project/frontend/src/components/SurveillanceHistory/SurveillanceHistory.js"],"names":["React","Component","LeftDrawer","videoStyles","axios","connect","SignalingClient","backendURL","Redirect","ReactHLS","Hls","$","AWS","Button","DateTimePicker","DatePicker","TimePicker","SurveillanceHistory","constructor","props","startDateChange","date","setState","startDate","endDateChange","endDate","startTimeChange","time","startTime","endTimeChange","endTime","convertMonth","month","handleSubmit","e","preventDefault","state","_d","toString","split","console","log","startMonth","endMonth","start","end","data","startTimeStamp","endTimeStamp","render","bind","componentDidMount","componentWillMount","protocol","streamName","playbackMode","playerName","options","accessKeyId","secretAccessKey","sessionToken","undefined","region","endpoint","kinesisVideo","KinesisVideo","kinesisVideoArchivedContent","KinesisVideoArchivedMedia","getDataEndpoint","StreamName","APIName","err","response","error","DataEndpoint","Endpoint","consoleInfo","Date","getHLSStreamingSessionURL","PlaybackMode","HLSFragmentSelector","FragmentSelectorType","TimestampRange","StartTimestamp","EndTimestamp","ContainerFormat","val","DiscontinuityMode","DisplayFragmentTimestamp","MaxMediaPlaylistFragmentResults","parseInt","Expires","HLSStreamingSessionURL","playerElement","show","player","loadSource","attachMedia","on","Events","MANIFEST_PARSED","play","videoDisplayContainer","videoDisplay","videoContainer","videoInfo","mapStateToProps","surveillanceReducer","mapDispatchStateToProps","dispatch","threats","get","then","threatsData","i","length","post","result","push","type","payload"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport '../../App.css';\r\nimport LeftDrawer from '../Drawer/Drawer';\r\nimport * as videoStyles from  \"../../styles/video\";\r\nimport axios from 'axios';\r\nimport { connect } from \"react-redux\";\r\nimport { SignalingClient } from 'amazon-kinesis-video-streams-webrtc';\r\nimport backendURL from '../../backendUrl';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport ReactHLS from 'react-hls';\r\nimport Hls from \"hls.js\";\r\nimport $ from \"jquery\";\r\nimport AWS from \"aws-sdk\";\r\nimport Button from '@material-ui/core/Button';\r\nimport DateTimePicker from 'react-datetime-picker';\r\nimport DatePicker from 'react-datepicker';\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\n\r\nimport TimePicker from 'rc-time-picker';\r\nimport 'rc-time-picker/assets/index.css';\r\n\r\nclass SurveillanceHistory extends Component {\r\n\r\n    constructor(props){\r\n        super(props); \r\n        this.state = {\r\n            startDate : null,\r\n            endDate : null,\r\n            startTime : null,\r\n            endTime : null,\r\n            startTimeStamp : null,\r\n            endTimeStamp : null\r\n        }\r\n       this.render = this.render.bind(this);\r\n        \r\n    }\r\n    componentDidMount(){\r\n       \r\n       // console.log(\"user : \"  + sessionStorage.getItem(\"user\"))\r\n       // if(sessionStorage.getItem(\"user\") == null)\r\n         //   this.setState({redirectVar : <Redirect to= \"/signin\"/>})\r\n       \r\n    }\r\n    componentWillMount (){\r\n       \r\n    }\r\n\r\n    \r\n    startDateChange = date => \r\n    {\r\n        this.setState({ startDate : date })\r\n    }\r\n    endDateChange = date => \r\n    {\r\n        this.setState({ endDate : date })\r\n    }\r\n\r\n    startTimeChange = time =>\r\n    {\r\n        this.setState({startTime : time});\r\n    }\r\n    endTimeChange = time =>\r\n    {\r\n        this.setState({endTime : time});\r\n    }\r\n    convertMonth = month =>\r\n    {\r\n        switch(month)\r\n        {\r\n            case 'Jan' : return 1;\r\n            case 'Feb' : return 2;\r\n            case 'Mar' : return 3;\r\n            case 'Apr' : return 4;\r\n            case 'May' : return 5;\r\n            case 'Jun' : return 6;\r\n            case 'Jul' : return 7;\r\n            case 'Aug' : return 8;\r\n            case 'Sept' : return 9;\r\n            case 'Oct' : return 10;\r\n            case 'Nov' : return 11;\r\n            case 'Dec' : return 12;\r\n        }\r\n    }\r\n    handleSubmit = e => \r\n    {\r\n        e.preventDefault();\r\n        if(this.state.startTime)\r\n        {\r\n        var startTime = this.state.startTime._d.toString().split(' ');\r\n        var startDate = this.state.startDate.toString().split(' ');\r\n        var endTime = this.state.endTime._d.toString().split(' ');\r\n        var endDate = this.state.endDate.toString().split(' ');\r\n\r\n        console.log(startTime);\r\n        console.log(startDate);\r\n\r\n        console.log(startTime[0]);\r\n        console.log(startDate[1]);\r\n\r\n        console.log(endTime[0]);\r\n        console.log(endTime[1]);\r\n      //  var startMonth = convertMonth(startDate[1]);\r\n      //  var endMonth = convertMonth(endDate[1]);\r\n      var startMonth, endMonth; \r\n      switch(startDate[1])\r\n        {\r\n            case 'Jan' : startMonth =  1; break;\r\n            case 'Feb' : startMonth =  2;break;\r\n            case 'Mar' : startMonth =  3;break;\r\n            case 'Apr' : startMonth =  4;break;\r\n            case 'May' : startMonth =  5;break;\r\n            case 'Jun' : startMonth =  6;break;\r\n            case 'Jul' : startMonth =  7;break;\r\n            case 'Aug' : startMonth =  8;break;\r\n            case 'Sept' : startMonth =  9;break;\r\n            case 'Oct' : startMonth =  10;break;\r\n            case 'Nov' : startMonth =  11;break;\r\n            case 'Dec' : startMonth =  12;\r\n        }\r\n\r\n        switch(endDate[1])\r\n        {\r\n            case 'Jan' : endMonth =  1;break;\r\n            case 'Feb' : endMonth =  2;break;\r\n            case 'Mar' : endMonth =  3;break;\r\n            case 'Apr' : endMonth =  4;break;\r\n            case 'May' : endMonth =  5;break;\r\n            case 'Jun' : endMonth =  6;break;\r\n            case 'Jul' : endMonth =  7;break;\r\n            case 'Aug' : endMonth =  8;break;\r\n            case 'Sept' : endMonth =  9;break;\r\n            case 'Oct' : endMonth =  10;break;\r\n            case 'Nov' : endMonth =  11;break;\r\n            case 'Dec' : endMonth =  12;\r\n        }\r\n        var start = startDate[3]+ '-' + startMonth + '-' + startDate[2] + 'T' + startTime[4] + '.000Z' ;\r\n        var end = endDate[3]+ '-' + endMonth +'-' +  endDate[2] + 'T' + endTime[4] + '.000Z' ;\r\n        var data = {\r\n            start : start, \r\n            end : end\r\n        }\r\n       // this.props.setTimeStamp(data);\r\n       this.setState({\r\n           startTimeStamp : start,\r\n           endTimeStamp : end\r\n       })\r\n/*2020-04-19T23:35:10.551Z\r\n2020-04-19T23:40:04.447Z*/\r\n    }\r\n    }\r\n   \r\n    render() {\r\n     var startTimeStamp = this.state.startTimeStamp + '';\r\n     var endTimeStamp = this.state.endTimeStamp;\r\n       \r\n        var protocol = 'HLS';\r\n        var streamName = 'threatStream';\r\n        var playbackMode = 'ON_DEMAND';\r\n        var playerName = 'HLS.js';\r\n\r\n        var options = {\r\n            accessKeyId: 'AKIAXBXQVKC4TY2ZUR6V',\r\n            secretAccessKey: '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',\r\n            sessionToken:  undefined,\r\n            region: 'us-east-1',\r\n            endpoint: undefined\r\n        }\r\n        var kinesisVideo = new AWS.KinesisVideo(options);\r\n        var kinesisVideoArchivedContent = new AWS.KinesisVideoArchivedMedia(options);\r\n        kinesisVideo.getDataEndpoint({\r\n            StreamName: streamName,\r\n            APIName: \"GET_HLS_STREAMING_SESSION_URL\"\r\n        }, function(err, response) {\r\n            if (err) { return console.error(err); }\r\n            console.log('Data endpoint: ' + response.DataEndpoint);\r\n            kinesisVideoArchivedContent.endpoint = new AWS.Endpoint(response.DataEndpoint);\r\n\r\n            // Step 3: Get a Streaming Session URL\r\n            var consoleInfo = 'Fetching ' + protocol + ' Streaming Session URL';\r\n            console.log(consoleInfo);\r\n            console.log( startTimeStamp );\r\n            console.log(typeof startTimeStamp);\r\n            console.log(typeof '2020-04-20T04:29:49.000Z');\r\n            console.log(new Date('2020-04-20T04:29:49.000Z'));\r\n            \r\n            console.log(startTimeStamp === '2020-04-20T04:29:49.000Z' );\r\n            \r\n                kinesisVideoArchivedContent.getHLSStreamingSessionURL({\r\n                    StreamName: streamName,\r\n                    PlaybackMode: playbackMode,\r\n                    HLSFragmentSelector: {\r\n                        FragmentSelectorType: 'SERVER_TIMESTAMP',\r\n                        TimestampRange:  {\r\n                            StartTimestamp: new Date('2020-04-20T04:29:49.000Z'),\r\n                            EndTimestamp: new Date('2020-04-20T05:29:49.000Z')\r\n                            \r\n                        }\r\n                    },\r\n                    ContainerFormat: $('#containerFormat').val(),\r\n                    DiscontinuityMode: $('#discontinuityMode').val(),\r\n                    DisplayFragmentTimestamp: $('#displayFragmentTimestamp').val(),\r\n                    MaxMediaPlaylistFragmentResults: parseInt($('#maxResults').val()),\r\n                    Expires: parseInt($('#expires').val())\r\n                }, function(err, response) {\r\n                    if (err) { return console.log(err); }\r\n                    console.log('HLS Streaming Session URL: ' + response.HLSStreamingSessionURL);\r\n\r\n                    // Step 4: Give the URL to the video player.\r\n               \r\n                        var playerElement = $('#hlsjs');\r\n                        playerElement.show();\r\n                        var player = new Hls();\r\n                        console.log('Created HLS.js Player');\r\n                        player.loadSource(response.HLSStreamingSessionURL);\r\n                        player.attachMedia(playerElement[0]);\r\n                        console.log('Set player source');\r\n                        player.on(Hls.Events.MANIFEST_PARSED, function() {\r\n                            $('#hlsjs').play();\r\n                            console.log('Starting playback');\r\n                        });\r\n                    \r\n                });\r\n        \r\n        });\r\n\r\n            return (\r\n           <div>\r\n                 <LeftDrawer></LeftDrawer>\r\n                 <div style={videoStyles.videoDisplayContainer}  >\r\n                           <video style={videoStyles.videoDisplay} id=\"hlsjs\"  controls autoPlay></video>\r\n\r\n                      </div> \r\n                 <div  style={videoStyles.videoContainer}  >\r\n\r\n                 \r\n                   <div style = {videoStyles.videoInfo}> {/*  <DateTimePicker\r\n          onChange={this.onChange}\r\n          value={this.state.date}\r\n        /> */}\r\n        <form onSubmit = {this.handleSubmit}>\r\n            <h5> Enter Start Date <DatePicker selected = {this.state.startDate} onChange = {this.startDateChange} style ={'border : 1px'}/> Enter Start Time <TimePicker onChange={this.startTimeChange}> </TimePicker></h5>\r\n            <h5> Enter End Date <DatePicker selected = {this.state.endDate} onChange = {this.endDateChange}/> Enter End Time <TimePicker onChange={this.endTimeChange}></TimePicker></h5>\r\n            <Button type=\"submit\">Go</Button>\r\n        </form>\r\n        {/*  <form><h5>Start TimeStamp <input id=\"start\"></input>End TimeStamp <input id=\"end\"></input></h5><Button>Go</Button></form> */}\r\n        <input id=\"startTimestamp\" type=\"datetime-local\" class=\"form-control form-control-sm\"/>\r\n        <input id=\"endTimestamp\" type=\"datetime-local\" class=\"form-control form-control-sm\"/>\r\n                                     \r\n               </div>\r\n               </div>\r\n          \r\n                \r\n            </div> \r\n\r\n            );\r\n    \r\n    }\r\n}\r\n\r\n\r\nconst mapStateToProps = state =>{\r\n   \r\n    return {\r\n        \r\n        startTimeStamp : state.surveillanceReducer.startTimeStamp,\r\n        endTimeStamp : state.surveillanceReducer.endTimeStamp\r\n     }\r\n}\r\n\r\nconst mapDispatchStateToProps = dispatch => {\r\n    \r\n    return {\r\n      //  setTimeStamp : (data) =>{\r\n      //      dispatch({type : \"history-timestamps\",data });\r\n      //  },\r\n        threats : () => {\r\n          /*  axios.get(backendURL + '/all-threats').then(response=>{\r\n                console.log(response.data);\r\n              // const threatIds = response.data;\r\n               axios.post(backendURL + '/threat-details', response.data).then(response=>{\r\n                      //   console.log(result);\r\n                         dispatch({type: \"threats\",payload : response.data})\r\n                })\r\n\r\n                \r\n            }) */\r\n            axios.get(backendURL + '/all-threats').then(response=>{\r\n          \r\n                var threatsData = [];\r\n                //dispatch({type: \"threats\",payload : response.data})\r\n                for(var i = 0; i<response.data.length; i++)\r\n                {\r\n                    axios.post(backendURL + '/threat-details', response.data[i]).then(result=>{\r\n                        threatsData.push(result.data);\r\n                \r\n                    }).then(function()  {\r\n                        \r\n                    if(threatsData.length == response.data.length)    \r\n                        dispatch({type: \"threats\",payload : threatsData})\r\n                    })\r\n                }\r\n               \r\n            }) \r\n\r\n        },\r\n    }\r\n}\r\n\r\nexport default (connect(mapStateToProps,mapDispatchStateToProps)(SurveillanceHistory));  \r\n"]},"metadata":{},"sourceType":"module"}