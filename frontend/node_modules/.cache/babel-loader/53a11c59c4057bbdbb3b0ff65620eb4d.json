{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Aysha\\\\Desktop\\\\Aysha\\\\SJSU\\\\Fall 2019\\\\CMPE 295A\\\\project\\\\frontend\\\\src\\\\components\\\\SurveillanceHistory\\\\SurveillanceHistory.js\";\nimport React, { Component } from \"react\";\nimport '../../App.css';\nimport LeftDrawer from '../Drawer/Drawer';\nimport * as videoStyles from \"../../styles/video\";\nimport axios from 'axios';\nimport { connect } from \"react-redux\";\nimport backendURL from '../../backendUrl';\nimport { Redirect } from \"react-router-dom\";\nimport Hls from \"hls.js\";\nimport $ from \"jquery\";\nimport AWS from \"aws-sdk\";\nimport Button from '@material-ui/core/Button';\nimport DatePicker from 'react-datepicker';\nimport TimeField from 'react-simple-timefield';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport * as buttonStyles from \"../../styles/button\";\nimport * as awsConfig from \"../../aws-config/aws\";\nimport TimePicker from 'rc-time-picker';\nimport 'rc-time-picker/assets/index.css';\n\nclass SurveillanceHistory extends Component {\n  constructor(props) {\n    super(props);\n\n    this.startDateChange = date => {\n      this.setState({\n        startDate: date\n      });\n    };\n\n    this.endDateChange = date => {\n      this.setState({\n        endDate: date\n      });\n    };\n\n    this.startTimeChange = e => {\n      e.preventDefault();\n      this.setState({\n        startTime: e.target.value\n      });\n    };\n\n    this.endTimeChange = e => {\n      e.preventDefault();\n      this.setState({\n        endTime: e.target.value\n      });\n    };\n\n    this.convertMonth = month => {\n      switch (month) {\n        case 'Jan':\n          return 1;\n\n        case 'Feb':\n          return 2;\n\n        case 'Mar':\n          return 3;\n\n        case 'Apr':\n          return 4;\n\n        case 'May':\n          return 5;\n\n        case 'Jun':\n          return 6;\n\n        case 'Jul':\n          return 7;\n\n        case 'Aug':\n          return 8;\n\n        case 'Sept':\n          return 9;\n\n        case 'Oct':\n          return 10;\n\n        case 'Nov':\n          return 11;\n\n        case 'Dec':\n          return 12;\n      }\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n\n      if (this.state.startTime) {\n        var startDate = this.state.startDate.toString().split(' ');\n        var endDate = this.state.endDate.toString().split(' ');\n        var startMonth, endMonth;\n\n        switch (startDate[1]) {\n          case 'Jan':\n            startMonth = '01';\n            break;\n\n          case 'Feb':\n            startMonth = '02';\n            break;\n\n          case 'Mar':\n            startMonth = '03';\n            break;\n\n          case 'Apr':\n            startMonth = '04';\n            break;\n\n          case 'May':\n            startMonth = '05';\n            break;\n\n          case 'Jun':\n            startMonth = '06';\n            break;\n\n          case 'Jul':\n            startMonth = '07';\n            break;\n\n          case 'Aug':\n            startMonth = '08';\n            break;\n\n          case 'Sept':\n            startMonth = '09';\n            break;\n\n          case 'Oct':\n            startMonth = '10';\n            break;\n\n          case 'Nov':\n            startMonth = '11';\n            break;\n\n          case 'Dec':\n            startMonth = '12';\n        }\n\n        switch (endDate[1]) {\n          case 'Jan':\n            endMonth = '01';\n            break;\n\n          case 'Feb':\n            endMonth = '02';\n            break;\n\n          case 'Mar':\n            endMonth = '03';\n            break;\n\n          case 'Apr':\n            endMonth = '04';\n            break;\n\n          case 'May':\n            endMonth = '05';\n            break;\n\n          case 'Jun':\n            endMonth = '06';\n            break;\n\n          case 'Jul':\n            endMonth = '07';\n            break;\n\n          case 'Aug':\n            endMonth = '08';\n            break;\n\n          case 'Sept':\n            endMonth = '09';\n            break;\n\n          case 'Oct':\n            endMonth = '10';\n            break;\n\n          case 'Nov':\n            endMonth = '11';\n            break;\n\n          case 'Dec':\n            endMonth = '12';\n        }\n\n        var start = startDate[3] + '-' + startMonth + '-' + startDate[2] + 'T' + this.state.startTime + '.000Z';\n        var end = endDate[3] + '-' + endMonth + '-' + endDate[2] + 'T' + this.state.endTime + '.000Z';\n        var data = {\n          start: start,\n          end: end\n        };\n        this.setState({\n          startTimeStamp: start,\n          endTimeStamp: end\n        });\n      }\n    };\n\n    var redirectVar;\n\n    if (sessionStorage.getItem(\"user\") == null || sessionStorage.getItem(\"user\") == \"null\") {\n      redirectVar = React.createElement(Redirect, {\n        to: \"/signin\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 29\n        },\n        __self: this\n      });\n    } else {\n      redirectVar = null;\n    }\n\n    this.state = {\n      startDate: new Date(),\n      endDate: new Date(),\n      startTime: '14:30:00',\n      endTime: '14:30:00',\n      startTimeStamp: null,\n      endTimeStamp: null,\n      redirectVar: redirectVar\n    };\n    this.render = this.render.bind(this);\n  }\n\n  render() {\n    var startTimeStamp = this.state.startTimeStamp + '';\n    var endTimeStamp = this.state.endTimeStamp;\n    var protocol = 'HLS';\n    var streamName = 'threatStream';\n    var playbackMode = 'ON_DEMAND';\n    var options = {\n      accessKeyId: awsConfig.config.accessKeyId,\n      secretAccessKey: awsConfig.config.secretAccessKey,\n      sessionToken: undefined,\n      region: awsConfig.config.region,\n      endpoint: undefined\n    };\n    var kinesisVideo = new AWS.KinesisVideo(options);\n    var kinesisVideoArchivedContent = new AWS.KinesisVideoArchivedMedia(options);\n    kinesisVideo.getDataEndpoint({\n      StreamName: streamName,\n      APIName: \"GET_HLS_STREAMING_SESSION_URL\"\n    }, function (err, response) {\n      if (err) {\n        console.error(err);\n        return;\n      }\n\n      kinesisVideoArchivedContent.endpoint = new AWS.Endpoint(response.DataEndpoint);\n      kinesisVideoArchivedContent.getHLSStreamingSessionURL({\n        StreamName: streamName,\n        PlaybackMode: playbackMode,\n        HLSFragmentSelector: {\n          FragmentSelectorType: 'SERVER_TIMESTAMP',\n          TimestampRange: {\n            StartTimestamp: new Date(startTimeStamp),\n            EndTimestamp: new Date(endTimeStamp)\n          }\n        }\n      }, function (err, response) {\n        if (err) {\n          console.log(err);\n          return;\n        }\n\n        var playerElement = $('#hlsjs');\n        playerElement.show();\n        var player = new Hls();\n        player.loadSource(response.HLSStreamingSessionURL);\n        player.attachMedia(playerElement[0]);\n        player.on(Hls.Events.MANIFEST_PARSED, function () {\n          $('#hlsjs').play();\n        });\n      });\n    });\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, this.state.redirectVar, React.createElement(LeftDrawer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: videoStyles.videoDisplayContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, React.createElement(\"video\", {\n      style: videoStyles.videoDisplay,\n      id: \"hlsjs\",\n      controls: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      style: videoStyles.videoContainer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: videoStyles.historyInput,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, React.createElement(\"table\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      style: videoStyles.colOne,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, \" Enter Start Date \", React.createElement(DatePicker, {\n      selected: this.state.startDate,\n      onChange: this.startDateChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }), \" \"), \" \", React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, \"Enter Start Time  \", React.createElement(TimeField, {\n      value: this.state.startTime,\n      onChange: this.startTimeChange,\n      colon: \":\",\n      showSeconds: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }), \" \", \"  \")), React.createElement(\"td\", {\n      style: videoStyles.colTwo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, \" Enter End Date \", React.createElement(DatePicker, {\n      selected: this.state.endDate,\n      onChange: this.endDateChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }), \" \"), \" \", React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, \" Enter End Time \", React.createElement(TimeField, {\n      value: this.state.endTime,\n      onChange: this.endTimeChange,\n      colon: \":\",\n      showSeconds: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }), \" \", \" \")), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, React.createElement(Button, {\n      style: buttonStyles.goButton,\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }, \"Go\"))))))));\n  }\n\n}\n\nexport default SurveillanceHistory;","map":{"version":3,"sources":["C:/Users/Aysha/Desktop/Aysha/SJSU/Fall 2019/CMPE 295A/project/frontend/src/components/SurveillanceHistory/SurveillanceHistory.js"],"names":["React","Component","LeftDrawer","videoStyles","axios","connect","backendURL","Redirect","Hls","$","AWS","Button","DatePicker","TimeField","buttonStyles","awsConfig","TimePicker","SurveillanceHistory","constructor","props","startDateChange","date","setState","startDate","endDateChange","endDate","startTimeChange","e","preventDefault","startTime","target","value","endTimeChange","endTime","convertMonth","month","handleSubmit","state","toString","split","startMonth","endMonth","start","end","data","startTimeStamp","endTimeStamp","redirectVar","sessionStorage","getItem","Date","render","bind","protocol","streamName","playbackMode","options","accessKeyId","config","secretAccessKey","sessionToken","undefined","region","endpoint","kinesisVideo","KinesisVideo","kinesisVideoArchivedContent","KinesisVideoArchivedMedia","getDataEndpoint","StreamName","APIName","err","response","console","error","Endpoint","DataEndpoint","getHLSStreamingSessionURL","PlaybackMode","HLSFragmentSelector","FragmentSelectorType","TimestampRange","StartTimestamp","EndTimestamp","log","playerElement","show","player","loadSource","HLSStreamingSessionURL","attachMedia","on","Events","MANIFEST_PARSED","play","videoDisplayContainer","videoDisplay","videoContainer","historyInput","colOne","colTwo","goButton"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport '../../App.css';\r\nimport LeftDrawer from '../Drawer/Drawer';\r\nimport * as videoStyles from  \"../../styles/video\";\r\nimport axios from 'axios';\r\nimport { connect } from \"react-redux\";\r\nimport backendURL from '../../backendUrl';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport Hls from \"hls.js\";\r\nimport $ from \"jquery\";\r\nimport AWS from \"aws-sdk\";\r\nimport Button from '@material-ui/core/Button';\r\nimport DatePicker from 'react-datepicker';\r\nimport TimeField from 'react-simple-timefield';\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\nimport * as buttonStyles from \"../../styles/button\";\r\nimport * as awsConfig from \"../../aws-config/aws\";\r\nimport TimePicker from 'rc-time-picker';\r\nimport 'rc-time-picker/assets/index.css';\r\n\r\nclass SurveillanceHistory extends Component {\r\n\r\n    constructor(props){\r\n        super(props); \r\n        var redirectVar;\r\n\r\n        if(sessionStorage.getItem(\"user\") == null || sessionStorage.getItem(\"user\") == \"null\")\r\n       {\r\n            redirectVar =  <Redirect to= \"/signin\"/>\r\n        \r\n       }\r\n       else{\r\n   \r\n               redirectVar =  null\r\n          \r\n        \r\n    \r\n       }\r\n        this.state = {\r\n            startDate : new Date(),\r\n            endDate : new Date(),\r\n            startTime : '14:30:00',\r\n            endTime : '14:30:00',\r\n            startTimeStamp : null,\r\n            endTimeStamp : null,\r\n            redirectVar : redirectVar\r\n        \r\n        }\r\n       this.render = this.render.bind(this);\r\n        \r\n    }\r\n  \r\n    \r\n    startDateChange = date => \r\n    {\r\n        this.setState({ startDate : date })\r\n    }\r\n    endDateChange = date => \r\n    {\r\n        this.setState({ endDate : date })\r\n    }\r\n\r\n    startTimeChange = (e) =>\r\n    {\r\n        e.preventDefault();\r\n        \r\n        this.setState({startTime : e.target.value});\r\n    }\r\n    endTimeChange = (e) =>\r\n    {\r\n        e.preventDefault();\r\n        this.setState({endTime : e.target.value});\r\n    }\r\n    convertMonth = month =>\r\n    {\r\n        switch(month)\r\n        {\r\n            case 'Jan' : return 1;\r\n            case 'Feb' : return 2;\r\n            case 'Mar' : return 3;\r\n            case 'Apr' : return 4;\r\n            case 'May' : return 5;\r\n            case 'Jun' : return 6;\r\n            case 'Jul' : return 7;\r\n            case 'Aug' : return 8;\r\n            case 'Sept' : return 9;\r\n            case 'Oct' : return 10;\r\n            case 'Nov' : return 11;\r\n            case 'Dec' : return 12;\r\n        }\r\n    }\r\n    handleSubmit = (e) => \r\n    {\r\n        e.preventDefault();\r\n        if(this.state.startTime)\r\n        {\r\n            \r\n        var startDate = this.state.startDate.toString().split(' ');\r\n       \r\n        var endDate = this.state.endDate.toString().split(' ');\r\n\r\n      var startMonth, endMonth; \r\n      switch(startDate[1])\r\n        {\r\n            case 'Jan' : startMonth =  '01'; break;\r\n            case 'Feb' : startMonth =  '02';break;\r\n            case 'Mar' : startMonth =  '03';break;\r\n            case 'Apr' : startMonth =  '04';break;\r\n            case 'May' : startMonth =  '05';break;\r\n            case 'Jun' : startMonth =  '06';break;\r\n            case 'Jul' : startMonth =  '07';break;\r\n            case 'Aug' : startMonth =  '08';break;\r\n            case 'Sept' : startMonth =  '09';break;\r\n            case 'Oct' : startMonth =  '10';break;\r\n            case 'Nov' : startMonth =  '11';break;\r\n            case 'Dec' : startMonth =  '12';\r\n        }\r\n\r\n        switch(endDate[1])\r\n        {\r\n            case 'Jan' : endMonth =  '01';break;\r\n            case 'Feb' : endMonth =  '02';break;\r\n            case 'Mar' : endMonth =  '03';break;\r\n            case 'Apr' : endMonth =  '04';break;\r\n            case 'May' : endMonth =  '05';break;\r\n            case 'Jun' : endMonth =  '06';break;\r\n            case 'Jul' : endMonth =  '07';break;\r\n            case 'Aug' : endMonth =  '08';break;\r\n            case 'Sept' : endMonth =  '09';break;\r\n            case 'Oct' : endMonth =  '10';break;\r\n            case 'Nov' : endMonth =  '11';break;\r\n            case 'Dec' : endMonth =  '12';\r\n        }\r\n     \r\n        var start = startDate[3]+ '-' + startMonth + '-' + startDate[2] + 'T' + this.state.startTime + '.000Z' ;\r\n        var end = endDate[3]+ '-' + endMonth +'-' +  endDate[2] + 'T' + this.state.endTime + '.000Z' ;\r\n        var data = {\r\n            start : start, \r\n            end : end\r\n        }\r\n      \r\n       this.setState({\r\n           startTimeStamp : start,\r\n           endTimeStamp : end\r\n       })\r\n\r\n    }\r\n    }\r\n   \r\n    render() {\r\n     var startTimeStamp = this.state.startTimeStamp + '';\r\n     var endTimeStamp = this.state.endTimeStamp;\r\n       \r\n        var protocol = 'HLS';\r\n        var streamName = 'threatStream';\r\n        var playbackMode = 'ON_DEMAND';\r\n\r\n        var options = {\r\n            accessKeyId: awsConfig.config.accessKeyId,\r\n            secretAccessKey: awsConfig.config.secretAccessKey,\r\n            sessionToken:  undefined,\r\n            region: awsConfig.config.region,\r\n            endpoint: undefined\r\n        }\r\n        var kinesisVideo = new AWS.KinesisVideo(options);\r\n        var kinesisVideoArchivedContent = new AWS.KinesisVideoArchivedMedia(options);\r\n        kinesisVideo.getDataEndpoint({\r\n            StreamName: streamName,\r\n            APIName: \"GET_HLS_STREAMING_SESSION_URL\"\r\n        }, function(err, response) {\r\n            if (err) { \r\n                 console.error(err); \r\n                 return;\r\n            }\r\n            kinesisVideoArchivedContent.endpoint = new AWS.Endpoint(response.DataEndpoint);\r\n            \r\n                kinesisVideoArchivedContent.getHLSStreamingSessionURL({\r\n                    StreamName: streamName,\r\n                    PlaybackMode: playbackMode,\r\n                    HLSFragmentSelector: {\r\n                        FragmentSelectorType: 'SERVER_TIMESTAMP',\r\n                        TimestampRange:  {\r\n                            StartTimestamp: new Date(startTimeStamp),\r\n                            EndTimestamp: new Date(endTimeStamp)\r\n                            \r\n                        }\r\n                    }\r\n                }, function(err, response) {\r\n                    if (err) { \r\n                         console.log(err); \r\n                         return;\r\n                    }\r\n                 \r\n               \r\n                        var playerElement = $('#hlsjs');\r\n                        playerElement.show();\r\n                        var player = new Hls();\r\n                        player.loadSource(response.HLSStreamingSessionURL);\r\n                        player.attachMedia(playerElement[0]);\r\n                        player.on(Hls.Events.MANIFEST_PARSED, function() {\r\n                            $('#hlsjs').play();\r\n                        });\r\n                    \r\n                });\r\n        \r\n        });\r\n\r\n            return (\r\n           <div>\r\n               {this.state.redirectVar}\r\n                 <LeftDrawer></LeftDrawer>\r\n                 <div style={videoStyles.videoDisplayContainer}  >\r\n                           <video style={videoStyles.videoDisplay} id=\"hlsjs\"  controls ></video>\r\n\r\n                      </div> \r\n                  <div  style={videoStyles.videoContainer}  > \r\n\r\n                 \r\n                   <div style = {videoStyles.historyInput}> \r\n        <form onSubmit = {this.handleSubmit}>\r\n            <table >\r\n                <tr  >\r\n                    <td  style={videoStyles.colOne}>\r\n                         <h5> Enter Start Date <DatePicker selected = {this.state.startDate} onChange = {this.startDateChange} /> </h5> <h5>Enter Start Time  <TimeField value= {this.state.startTime} onChange={this.startTimeChange} colon=\":\" showSeconds /> {/*< TimePicker onChange={this.startTimeChange}> </TimePicker>*/}  </h5>\r\n                    </td>\r\n                    <td style={videoStyles.colTwo}>\r\n                          <h5> Enter End Date <DatePicker selected = {this.state.endDate} onChange = {this.endDateChange}/> </h5> <h5> Enter End Time <TimeField  value= {this.state.endTime} onChange={this.endTimeChange} colon=\":\" showSeconds /> {/* <TimePicker onChange={this.endTimeChange}></TimePicker>*/} </h5>\r\n                    </td>\r\n                    <td>\r\n                          <Button style={buttonStyles.goButton} type=\"submit\">Go</Button>\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </form>\r\n    \r\n                                     \r\n               </div>\r\n               </div> \r\n          \r\n                \r\n            </div> \r\n\r\n            );\r\n    \r\n    }\r\n}\r\n\r\n\r\nexport default SurveillanceHistory;  \r\n"]},"metadata":{},"sourceType":"module"}